/*! weekend4 2016-03-21 */
function handleSubmit(a){a.preventDefault();var b={};$.each($("#todoForm").serializeArray(),function(a,c){b[c.name]=c.value}),$("#todoForm").find("input[type=text]").val(""),console.log("form data",b),sendToServer(b)}function sendToServer(a){$.ajax({type:"POST",url:"/todo",data:a,success:serverResponse})}function serverResponse(a){console.log("server response",a),getTodo(a)}function getTodo(){$.ajax({type:"GET",url:"/todo",success:todoInitial})}function todoInitial(a){console.log("get initial",a),appendDom(a)}function appendDom(a){$(".active").empty(),$(".completed").empty();for(var b=0;b<a.length;b++){if(0==a[b].completed){$(".active").append('<div class="todo"></div>'),a[b].completed="Not Completed";var c=$(".active").children().last()}else if(1==a[b].completed){$(".completed").append('<div class="todo"></div>'),a[b].completed="Completed";var c=$(".completed").children().last()}c.append("<h3>"+a[b].task+"</h3>"),c.append("<p>"+a[b].completed+"</p>"),c.append('<button class="markComplete">Mark Complete</button>'),c.append('<button class="delete">Delete Task</button>'),c.data("id",a[b].id),c.data("task",a[b].task)}}function deleteTask(){var a={};a.id=$(this).parent().data("id"),$(this).parent().remove(),$.ajax({type:"DELETE",url:"/todo",data:a,success:taskDeleted})}function taskDeleted(){console.log("delete works")}function markComplete(){console.log("mark complete works");var a={};a.id=$(this).parent().data("id"),a.task=$(this).parent().data("task"),a.completed=!0,$(this).parent().remove(),$.ajax({type:"PUT",url:"/todo",data:a,success:taskUpdated})}function taskUpdated(a){console.log("update works",a),getTodo(a)}$(document).ready(function(){$("#todoForm").on("submit",handleSubmit),$(".active").on("click",".markComplete",markComplete),$(".container").on("click",".delete",deleteTask),getTodo()}),console.log("connected");